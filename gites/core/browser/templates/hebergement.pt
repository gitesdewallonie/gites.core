<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="gites">
<body>

    <metal:javascript_head_slot fill-slot="javascript_head_slot"
                                tal:define="hasCalendar view/showCalendar">
        <script type="text/javascript"
                charset="utf-8"
                src=""
                tal:attributes="src string:${context/@@plone_portal_state/portal_url}/++resource++prototype16.js"></script>

        <script type="text/javascript"
                charset="utf-8"
                src=""
                tal:attributes="src string:${context/@@plone_portal_state/portal_url}/++resource++gitetimeframe.js"></script>

        <script type="text/javascript"
                charset="utf-8"
                tal:condition="hasCalendar"
                tal:content="view/calendarJS"></script>

        <script type="text/javascript"
                charset="utf-8"
                tal:condition="hasCalendar"
                tal:content="view/dispoCalendarJS"></script>

        <script type="text/javascript"
                src=""
                charset="utf-8"
                tal:attributes="src string:${context/@@plone_portal_state/portal_url}/++theme++gites.theme/accordeon/jquery.accordionza.min.js"></script>

        <script type="text/javascript"
                src=""
                charset="utf-8"
                tal:attributes="src string:${context/@@plone_portal_state/portal_url}/++theme++gites.theme/accordeon/script.js"></script>

        <script type="text/javascript"
                src=""
                charset="utf-8"
                tal:attributes="src string:${context/@@plone_portal_state/portal_url}/++theme++gites.theme/scripts/spin.js"></script>

        <script type="text/javascript"
                charset="utf-8"
                src=""
                tal:attributes="src string:${context/@@plone_portal_state/portal_url}/++resource++gdwcore/hebergement.js"></script>
    </metal:javascript_head_slot>

    <metal:css fill-slot="css_slot">
        <link rel="stylesheet"
              href=""
              type="text/css"
              media="screen"
              title="timeframe"
              charset="utf-8"
              tal:attributes="href string:${context/@@plone_portal_state/portal_url}/++resource++timeframe.css" />
    </metal:css>

<div metal:fill-slot="main"
     tal:define="hasCalendar view/showCalendar">

    <div tal:replace="structure provider:plone.abovecontenttitle" />
    <div tal:replace="structure provider:plone.belowcontenttitle" />
    <div tal:replace="structure provider:plone.abovecontentbody" />

    <div id="content-core">

        <div id="description-heb"
             tal:define="heb context;
                         hebergementIcons context/@@hebergement_icons;
                         redirection view/redirectInactive;">
            <!-- Bannière titre + info -->
            <div id="description-info-sup"
                 tal:define="epis python:heb.epis and heb.epis[0] or None;
                             episValue python:epis and (epis.heb_nombre_epis > 0 and epis.heb_nombre_epis) or '-'">
                <div id="nom-heb">
                    <span tal:content="heb/heb_nom" />
                </div>
                <div id="reference"
                     class="etiquette-sup">
                    <span tal:content="heb/heb_pk" />
                    <tal:bloc i18n:translate="reference">référence</tal:bloc>
                </div>
                <div id="nbre-chambre"
                     class="etiquette-sup">
                    <span tal:content="heb/heb_cgt_nbre_chmbre" />
                    <tal:bloc i18n:translate="x_chambres">chambres</tal:bloc>
                </div>
                <div id="nbre-personne"
                     class="etiquette-sup">
                    <span tal:condition="python: heb.heb_cgt_cap_min != heb.heb_cgt_cap_max"
                          tal:content="string: ${heb/heb_cgt_cap_min}/${heb/heb_cgt_cap_max}" />
                    <span tal:condition="python: heb.heb_cgt_cap_min == heb.heb_cgt_cap_max"
                          tal:content="string: ${heb/heb_cgt_cap_min}" />
                    <tal:bloc i18n:translate="x_personnes">personnes</tal:bloc>
                </div>
                <div id="nbre-cle"
                     class="etiquette-sup"
                     tal:condition="python:heb.type.type_heb_code == 'MV'">
                    <span tal:content="episValue"/>
                    <tal:bloc i18n:translate="x_cles">cl&eacute;s</tal:bloc>
                </div>
                <div id="nbre-epis"
                     class="etiquette-sup"
                     tal:condition="python:heb.type.type_heb_code != 'MV'">
                    <span tal:content="episValue"/>
                    <tal:bloc i18n:translate="x_epis">&eacute;pis</tal:bloc>
                </div>

                <div class="break-float"></div>
            </div><!--info-sup-->

            <div id="accordeon-spin"></div>
            <script language="javascript">
                var opts = {
                    lines: 12,      // The number of lines to draw
                    length: 7,      // The length of each line
                    width: 5,       // The line thickness
                    radius: 10,     // The radius of the inner circle
                    color: '#fff',  // #rbg or #rrggbb
                    speed: 1,       // Rounds per second
                    trail: 66,      // Afterglow percentage
                    shadow: true    // Whether to render a shadow
                };
                var target = document.getElementById('accordeon-spin');
                var spinner = new Spinner(opts).spin(target);
            </script>

            <ul id="descriptif-accordeon"
                tal:define="lang request/LANGUAGE | fr;
                            languageAwareClass string:slide_handle_${lang}">

                <script language="javascript">
                    jQuery("#descriptif-accordeon").hide();
                </script>

                <!-- ACCUEIL -->
                <li class="slide slide1">
                    <div class="slide_handle"
                         tal:attributes="class string: slide_handle ${languageAwareClass}"><div></div></div>
                    <div class="slide_content">
                        <h2 i18n:translate="accueil">Accueil</h2>
                    <div>
                     <div id="description-icone-theme-giteplus">
                        <tal:for repeat="metadata python:view.getHebMetadatasByType('themes')">
                            <div class="button-theme">
                            <img src=""
                                 title=""
                                 alt=""
                                 tal:attributes="src string:${context/@@plone_portal_state/portal_url}/${metadata/id}.png;
                                                 alt metadata/title;
                                                 title metadata/title" />
                            </div>
                        </tal:for>

                        <tal:for repeat="metadata python:view.getHebMetadatasByType('gitesplus')">
                            <div class="button-theme">
                            <img src=""
                                 title=""
                                 alt=""
                                 tal:attributes="src string:${context/@@plone_portal_state/portal_url}/${metadata/id}.png;
                                                 alt metadata/title;
                                                 title metadata/title" />
                            </div>
                        </tal:for>
                    </div>


                    <div id="accueil-bloc-gauche">
                        <div id="description-photo-heb">
                            <img src="" width="300" height="195"
                                 alt="Photo hébergement"
                                 tal:attributes="src string:${here/photos_heb/absolute_url}/${heb/heb_code_gdw}00.jpg" />
                        </div>

                        <div id="description-adresse-hebergement">
                            <span tal:content="heb/heb_adresse" /><br/>
                            <span tal:content="heb/commune/com_cp" />
                            <span tal:content="heb/heb_localite" />
                            (<span tal:content="heb/commune/com_nom" />)
                        </div>

                        <div id="description-calendrier"
                             tal:condition="hasCalendar">
                            <div id="calendars"></div>
                            <input type="hidden"
                                   id="reset" />
                            <input type="hidden"
                                   name="start"
                                   value=""
                                   id="start" />
                            <input type="hidden"
                                   name="end"
                                   value=""
                                   id="end" />
                        </div>
                    </div><!--accueil-bloc-gauche-->


                    <div id="accueil-bloc-droite">
                    <!--TABLE TARIFICATION GITES-->

                    <div id="tarification-gite"
                         tal:condition="python:heb.type.type_heb_code not in 'CH, MH, CHECR'">
                        <table>
                            <tr class="tarif-periode">
                               <td i18n:translate="periode">Période</td>
                               <td i18n:translate="week-end">WE</td>
                               <td i18n:translate="semaine">Semaine</td>
                            </tr>
                            <tr>
                                <td class="tarif-saison" i18n:translate="basse_saison">Basse saison</td>
                                <td class="tarif-prix">
                                    <span tal:content="heb/heb_tarif_we_bs" />
                                </td>
                                <td class="tarif-prix">
                                     <span tal:content="heb/heb_tarif_sem_bs" />
                                </td>
                            </tr>
                            <tr bgcolor="#ceddce">
                                <td class="tarif-saison" i18n:translate="moyenne_saison">Moyenne saison</td>
                                <td class="tarif-prix">
                                    <span tal:content="heb/heb_tarif_we_ms" />
                                </td>
                                <td class="tarif-prix">
                                     <span tal:content="heb/heb_tarif_sem_ms" />
                                </td>
                            </tr>
                            <tr>
                                <td class="tarif-saison" i18n:translate="haute_saison">Haute saison</td>
                                <td class="tarif-prix">
                                     <span tal:content="heb/heb_tarif_we_hs" />
                                </td>
                                <td class="tarif-prix">
                                     <span tal:content="heb/heb_tarif_sem_hs" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">&nbsp;</td>
                            </tr>
                            <tr bgcolor="#ceddce">
                                <td class="tarif-saison" i18n:translate="3_nuits">WE de fête 3 nuits</td>
                                <td class="tarif-prix">
                                     <span tal:content="heb/heb_tarif_we_3n" />
                                </td>
                                <td class="tarif-prix">-</td>
                            </tr>
                            <tr>
                                <td class="tarif-saison" i18n:translate="4_nuits">WE de fête 4 nuits</td>
                                <td class="tarif-prix">
                                     <span tal:content="heb/heb_tarif_we_4n" />
                                </td>
                                <td class="tarif-prix">-</td>
                            </tr>
                            <tr>
                                <td colspan="3">&nbsp;</td>
                            </tr>
                            <tr bgcolor="#ceddce">
                                <td class="tarif-saison" i18n:translate="fin_d_annee">Fin d'ann&eacute;e</td>
                                <td class="tarif-prix">-</td>
                                <td class="tarif-prix">
                                     <span tal:content="heb/heb_tarif_semaine_fin_annee" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">&nbsp;</td>
                            </tr>
                            <tr bgcolor="#ceddce">
                                <td class="tarif-saison" i18n:translate="garantie">Garantie</td>
                                <td colspan="2" class="tarif-rpix">
                                    <span tal:content="heb/heb_tarif_garantie" />
                                </td>
                            </tr>
                            <tr>
                                <td class="tarif-saison" i18n:translate="charges">Charges</td>
                                <td colspan="2" class="tarif-prix">
                                    <span tal:condition="exists: heb/heb_tarif_charge">|
                                        <span tal:content="heb/heb_tarif_charge" />
                                        <span tal:content="view/getHebergementCharge" />
                                    </span>
                                    <span tal:condition="not: exists: heb/heb_tarif_charge">-</span>
                                </td>
                            </tr>
                            <tr bgcolor="#ceddce">
                                <td class="tarif-saison" i18n:translate="taxe_sejour">Taxe de séjour</td>
                                <td colspan="2"
                                    class="tarif-prix">
                                    <span tal:content="heb/heb_taxe_montant" />
                                </td>
                            </tr>
                         </table>
                        <div id="description-tarification-divers">
                            <h3>Divers</h3>
                            <p tal:content="heb/heb_tarif_divers"></p>
                        </div>
                    </div>

                    <!--TABLE TARIFICATION CHAMBRE-->
                    <div id="tarification-chambre"
                         tal:condition="python:heb.type.type_heb_code in 'CH, MH, CHECR'">
                        <table>
                            <tr class="tarif-periode">
                                <td>&nbsp;</td>
                                <td align="center"><span i18n:translate="1_p">1 p.</span></td>
                                <td align="center"><span i18n:translate="2_p">2 p.</span></td>
                                <td align="center"><span i18n:translate="p_plus">p. +</span></td>
                            </tr>
                            <tr bgcolor="#CED8E2">
                                <td class="tarif-saison">
                                    <span i18n:translate="nuit_avec_petit_dejeuner">Nuit&eacute;e avec petit d&eacute;jeuner</span>
                                </td>
                                <td class="tarif-prix empty-cell">
                                    <span tal:content="heb/heb_tarif_chmbr_avec_dej_1p" />
                                </td>
                                <td class="tarif-prix empty-cell">
                                    <span tal:content="heb/heb_tarif_chmbr_avec_dej_2p" />
                                </td>
                                <td class="tarif-prix empty-cell">
                                    <span tal:content="heb/heb_tarif_chmbr_avec_dej_3p" />
                                </td>
                            </tr>
                            <tr>
                                <td class="tarif-saison empty-cell">
                                    <span i18n:translate="deduction_si_pas_petit_dejeuner">D&eacute;duction si pas petit d&eacute;jeuner</span>
                                </td>
                                <td class="tarif-prix empty-cell">
                                    <span tal:content="heb/heb_tarif_chmbr_sans_dej_1p" />
                                </td>
                                <td class="tarif-prix empty-cell">
                                    <span tal:content="heb/heb_tarif_chmbr_sans_dej_2p" />
                                </td>
                                <td class="tarif-prix empty-cell">
                                    <span tal:content="heb/heb_tarif_chmbr_sans_dej_3p" />
                                </td>
                            </tr>
                            <tr bgcolor="#CED8E2">
                                <td class="tarif-saison">
                                    <span i18n:translate="taxe_sejour">Taxe de séjour</span>
                                </td>
                                <td class="tarif-prix empty-cell">
                                     <span tal:content="heb/heb_taxe_montant" />
                                </td>
                                <td class="tarif-prix empty-cell">&nbsp;</td>
                                <td class="tarif-prix empty-cell">&nbsp;</td>
                            </tr>
                        </table>
                        <div id="description-tarification-divers">
                            <h3 i18n:translate="divers">Divers</h3>
                            <span tal:content="heb/heb_tarif_chmbr_autre_1p" />
                        </div>
                 </div><!--tarif hebergement-->

                        <!-- TABLE TABLE D'HOTE-->
                        <div id="tarification-table-hote"
                             tal:condition="python:heb.type.type_heb_code in 'CH, MH, CHECR'"
                             tal:define="table_hote view/getTableHote">
                            <table>
                                <tr>
                                    <td colspan="2"
                                        class="tarif-periode"
                                        i18n:translate="table_hotes">
                                        Table d'hôtes
                                    </td>
                                </tr>
                                <tr>
                                    <td class="tarif-saison" i18n:translate="tarif">
                                        Tarif
                                    </td>
                                    <td tal:content="heb/heb_tarif_chmbr_table_hote_1p">
                                    </td>
                                </tr>
                                <tr>
                                    <td class="tarif-saison" i18n:translate="type">
                                        Type
                                    </td>
                                    <td>
                                        <span tal:content="table_hote">
                                        </span>
                                    </td>
                                </tr>
                            </table>
                        </div><!--tarif table hote-->
                        <div class="break-float"></div>
                    </div><!--accueil-bloc-droite-->
                </li>

                <!-- DESCRIPTION -->
                <li class="slide slide2">
                    <div class="slide_handle"
                         tal:attributes="class string: slide_handle ${languageAwareClass}"><div></div></div>
                    <div class="slide_content">
                        <h2 i18n:translate="description">Description</h2>
                        <div id="description-bloc-gauche">
                                <div id="heb-situation">
                                    <h3 i18n:translate="situation">Situation</h3>
                                    <p tal:content="view/getHebergementSituation"></p>
                                </div>
                                <div id="heb-distribution">
                                    <h3 i18n:translate="distribution">Distribution</h3>
                                    <p tal:content="view/getHebergementDistribution"></p>
                                </div>
                        </div><!--description-bloc-gauche-->

                        <div id="description-bloc-droite">
                                <div id="heb-description">
                                    <h3 i18n:translate="description">Description</h3>
                                    <p tal:content="view/getHebergementDescription"></p>
                                </div>
                        </div><!--description-bloc-gauche-->

                        <div class="break-float"></div>

                        <div id="description-icone-confort">
                                <tal:block define="metadata python:view.getAnimal()">
                                    <img src=""
                                         title=""
                                         alt=""
                                         class="picto"
                                         tal:attributes="src string:${context/@@plone_portal_state/portal_url}/${metadata/id}.png;
                                                         alt metadata/title;
                                                         title metadata/title" />
                                </tal:block>
                                <tal:block define="metadata python:view.getFumeur()">
                                    <img src=""
                                         title=""
                                         alt=""
                                         class="picto"
                                         tal:condition="python:metadata['id'] == 'heb_confort_no_fumeur'"
                                         tal:attributes="src string:${context/@@plone_portal_state/portal_url}/${metadata/id}.png;
                                                         alt metadata/title;
                                                         title metadata/title" />
                                </tal:block>
                                <tal:for repeat="metadata python:view.getHebMetadatasByType('confort')">
                                    <img src=""
                                         title=""
                                         alt=""
                                         class="picto"
                                         tal:attributes="src string:${context/@@plone_portal_state/portal_url}/${metadata/id}.png;
                                                         alt metadata/title;
                                                         title metadata/title" />
                                </tal:for>
                        </div><!--icone-confort-->
                    </div>
                </li>
                <!-- DISPONIBILITE -->
                <li class="slide slide3"
                    tal:attributes="class python: hasCalendar and 'slide slide3 used' or 'slide slide3 unused'">
                    <div class="slide_handle"
                         tal:attributes="class string: slide_handle ${languageAwareClass}"><div></div></div>
                    <div class="slide_content">
                        <h2 i18n:translate="disponibilites">Disponibilités</h2>
                        <div>
                            <div id="description-dispo-calendrier"
                                 tal:condition="hasCalendar">
                                <div id="dispocalendars"></div>
                                <input type="hidden"
                                       id="disporeset" />
                                <input type="hidden"
                                       name="dispostart"
                                       value=""
                                       id="dispostart" />
                                <input type="hidden"
                                       name="dispoend"
                                       value=""
                                       id="dispoend" />
                            </div>
                            <div tal:condition="not: hasCalendar">
                                <span i18n:translate="desoles_pas_de_calendrier_pour_ce_gite">
                                    Nous sommes désolés. Nous ne disposons pas des disponibilités pour cet hébergement.
                                </span>
                            </div>
                        </div>
                        <br />
                    </div>
                </li>
                <!-- PHOTOS -->
                <li class="slide slide4">
                    <div class="slide_handle"
                         tal:attributes="class string: slide_handle ${languageAwareClass}"><div></div></div>
                    <div class="slide_content">
                        <h2 i18n:translate="photos">Photos</h2>
                        <div tal:define="vignettesUrls view/getVignettesUrl;
                                         video heb/video">
                            <div id="hebergement-carousel" class="carousel slide" tal:condition="python: vignettesUrls or video">
                                <div class="carousel-inner">
                                  <tal:ifvideo tal:condition="video">
                                    <div class=""
                                         tal:define="index python: len(vignettesUrls)"
                                         tal:attributes="class python: int(index) == 0 and 'video item active' or 'video item'">
                                        <span tal:replace="structure python: view.getIframeForVideo(video.heb_vid_url)" />
                                    </div>
                                  </tal:ifvideo>
                                  <tal:bcl tal:repeat="vignetteUrl vignettesUrls">
                                    <div class=""
                                         tal:define="index repeat/vignetteUrl/index"
                                         tal:attributes="class python: int(index) == 0 and 'item active' or 'item'">
                                        <img src="" title="" alt=""
                                             tal:attributes="src string:${context/@@plone_portal_state/portal_url}/photos_heb/${vignetteUrl}">
                                    </div>
                                  </tal:bcl>
                                </div>
                                <a class="left carousel-control" href="#hebergement-carousel" data-slide="prev">&lsaquo;</a>
                                <a class="right carousel-control" href="#hebergement-carousel" data-slide="next">&rsaquo;</a>
                            </div>
                        </div>
                        <br />
                    </div>
                </li>
                <!-- LOCALISATION -->
                <li class="slide slide5">
                    <div class="slide_handle"
                         tal:attributes="class string: slide_handle ${languageAwareClass}"><div></div></div>
                    <div class="slide_content">
                        <h2 i18n:translate="localisation">Localisation</h2>
                        <div id="description-map" tal:content="structure provider:gites.mapviewlet" />
                        <div class="break-float"></div>
                    </div>
                </li>
                <!-- CONTACT -->
                <li class="slide slide6">
                    <div class="slide_handle"
                         tal:attributes="class string: slide_handle ${languageAwareClass}"><div></div></div>
                    <div class="slide_content">
                        <h2 i18n:translate="contact">Contact</h2>
                        <div id="description-coordonnee">
                            <div id="nom-proprio">
                                <span tal:content="heb/proprio/civilite/civ_titre" />
                                <span tal:replace="heb/proprio/pro_prenom1" />
                                <span tal:replace="heb/proprio/pro_prenom2" />
                                <span tal:replace="heb/proprio/pro_nom1" />
                                <span tal:replace="heb/proprio/pro_nom2" />
                            </div>
                            <div id="langue-proprio">
                                <span tal:replace="heb/proprio/pro_langue" />
                            </div>
                            <div id="phone-proprio">
                                <img src="icon_telephone.gif" alt="Téléphone" />
                                <span tal:replace="heb/proprio/pro_tel_priv" />
                            </div>
                            <div id="fax-proprio"
                                 tal:condition="python: heb.proprio.pro_fax_priv">
                                <img src="icon_fax.gif" alt="Fax" />
                                <span tal:replace="heb/proprio/pro_fax_priv" />
                            </div>
                            <div id="gsm-proprio"
                                 tal:condition="python: heb.proprio.pro_gsm1">
                                <img src="icon_gsm.gif" alt="GSM" />
                                <span tal:replace="heb/proprio/pro_gsm1" />
                            </div>
                            <div id="email-proprio"
                                 tal:condition="python: heb.proprio.pro_email">
                                <img src="icon_email.gif" alt="E-mail" />
                                <span tal:replace="heb/proprio/pro_email" />
                            </div>
                            <div id="url-proprio"
                                 tal:condition="python: heb.proprio.pro_url">
                                <img src="icon_lien.gif" alt="Site web" />
                                <a href=""
                                   tal:attributes="href string: http://${heb/proprio/pro_url}"
                                   tal:content="string: http://${heb/proprio/pro_url}"
                                   target="_blank" />
                            </div>
                            <div id="contacter-proprio">
                                <a href=""
                                   tal:attributes="href string:${context/@@plone_portal_state/portal_url}/form_contact_proprio?heb_pk=${heb/heb_pk}">
                                    <span i18n:translate="contactez_le_proprietaire">Contactez le propri&eacute;taire</span>
                                </a>
                            </div>
                        </div><!--descriptif coordonnee-->
                        <div id="description-photo-proprio"
                             tal:define="photocontact view/getPhotoContact">
                            <img src="" width="196" height="170" alt=""
                                 tal:condition="photocontact"
                                 tal:attributes="src string:${context/@@plone_portal_state/portal_url}/photos_proprio/${heb/proprio/pro_pk}.jpg" />
                        </div><!-- descriptif p hoto proprio-->
                        <div class="break-float"></div>
                    </div>
                </li>
            </ul>
            <div id="signaler-un-probleme">
                <a href="#"
                   tal:attributes="href string:${context/@@plone_portal_state/portal_url}/signaler_probleme"
                   i18n:translate="signaler-un-probleme"> Signaler un problème </a>
            </div>
            <div class="break-float"></div>

        </div><!--define-->

    </div>

</div><!--metal-->
</body>
</html>
